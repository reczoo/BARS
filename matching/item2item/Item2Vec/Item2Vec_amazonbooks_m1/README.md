# Item2Vec_amazonbooks_x0

A notebook to benchmark Item2Vec on amazonbooks_x0 dataset.

Author: Yi Li, Tsinghua University

Edited by [XUEPAI Team](https://github.com/xue-pai)

### Index

[Environments](#Environments) | [Dataset](#Dataset) | [Code](#Code) | [Results](#Results)| [Logs](#Logs) 

### Environments

* Hardware

```shell
CPU: Intel(R) Xeon(R) Silver 4210R CPU @ 2.40GHz
RAM: 125G
GPU: GeForce RTX 2080Ti, 11G memory
```

* Software

```shell
python: 3.6.2
pytorch: 1.1.0
torchvision: 0.3.0
```

### Dataset

We directly use the `amazon-book` dataset provided in their [repo](https://github.com/kuandeng/LightGCN/tree/master/Data). So you can put the `train.txt` and `test.txt` in the corresponding data set downloaded from the [LightGCN repo](https://github.com/kuandeng/LightGCN/tree/master/Data) into the data/AmazonBooks/amazonbooks_x0 directory.

### Code

1. This benchmark is implemented based on a public repository for the recommendation, daisyRec: https://github.com/AmazingDD/daisyRec/tree/dff66b71a4d360eae7bf4edec5df1d4941937cb2. We use the version with commit hash: dff66b7.

2. Based on the Item2Vec model defined in the  [daisyRec repo](https://github.com/AmazingDD/daisyRec/blob/dev/daisy/model/Item2VecRecommender.py), we perform data processing, model call and metrics calculation in the `Item2Vec.py` file.

3. Run the following script to reproduce the result.

   ```shell
   python Item2Vec.py --dataset AmazonBooks --window 20 --n_negs 20 --batch_size 4096 --gpu_id 1
   ```

### Results

```
HR@20 = 0.18973, Recall@20 = 0.03265, NDCG@20 = 0.02516
HR@50 = 0.31924, Recall@50 = 0.06234, NDCG@50 = 0.03614
```

### Logs

```shell
Namespace(batch_size=4096, dataset='AmazonBooks', emb_dim=64, epochs=200, n_negs=20, topk='[20, 50]', window=20, gpu_id=1)
building vocab...
build done
converting train by corpus build before...
conversion done
model fitting...
[Epoch 1]: 100%|█████████████████████████████████████████████████████████████████████████████████| 582/582 [02:06<00:00,  4.61it/s, loss=3.2]
[Epoch 2]: 100%|███████████████████████████████████████████████████████████████████████████████████| 582/582 [02:00<00:00,  4.84it/s, loss=3]
[Epoch 3]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [01:59<00:00,  4.88it/s, loss=2.97]
[Epoch 4]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.68it/s, loss=2.89]
[Epoch 5]: 100%|█████████████████████████████████████████████████████████████████████████████████| 582/582 [02:05<00:00,  4.63it/s, loss=2.7]
[Epoch 6]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.70it/s, loss=2.54]
[Epoch 7]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.74it/s, loss=2.36]
[Epoch 8]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:05<00:00,  4.63it/s, loss=2.21]
[Epoch 9]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:06<00:00,  4.62it/s, loss=2.02]
[Epoch 10]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:06<00:00,  4.61it/s, loss=1.96]
[Epoch 11]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:07<00:00,  4.58it/s, loss=1.91]
[Epoch 12]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.67it/s, loss=1.87]
[Epoch 13]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:10<00:00,  4.46it/s, loss=1.84]
[Epoch 14]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:08<00:00,  4.52it/s, loss=1.81]
[Epoch 15]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.76it/s, loss=1.83]
[Epoch 16]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.69it/s, loss=1.77]
[Epoch 17]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.81it/s, loss=1.76]
[Epoch 18]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.81it/s, loss=1.75]
[Epoch 19]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.68it/s, loss=1.79]
[Epoch 20]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.75it/s, loss=1.75]
[Epoch 21]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.77it/s, loss=1.74]
[Epoch 22]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [01:58<00:00,  4.90it/s, loss=1.69]
[Epoch 23]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.79it/s, loss=1.71]
[Epoch 24]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.71it/s, loss=1.7]
[Epoch 25]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.71it/s, loss=1.73]
[Epoch 26]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:05<00:00,  4.65it/s, loss=1.75]
[Epoch 27]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.69it/s, loss=1.7]
[Epoch 28]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.67it/s, loss=1.7]
[Epoch 29]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.72it/s, loss=1.67]
[Epoch 30]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.76it/s, loss=1.71]
[Epoch 31]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.66it/s, loss=1.68]
[Epoch 32]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:05<00:00,  4.64it/s, loss=1.66]
[Epoch 33]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.75it/s, loss=1.66]
[Epoch 34]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.75it/s, loss=1.7]
[Epoch 35]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.76it/s, loss=1.66]
[Epoch 36]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.72it/s, loss=1.67]
[Epoch 37]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [01:59<00:00,  4.87it/s, loss=1.62]
[Epoch 38]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.68it/s, loss=1.61]
[Epoch 39]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.67it/s, loss=1.63]
[Epoch 40]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.69it/s, loss=1.6]
[Epoch 41]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.78it/s, loss=1.62]
[Epoch 42]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.75it/s, loss=1.56]
[Epoch 43]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.74it/s, loss=1.6]
[Epoch 44]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.67it/s, loss=1.59]
[Epoch 45]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.70it/s, loss=1.64]
[Epoch 46]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.67it/s, loss=1.64]
[Epoch 47]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.79it/s, loss=1.57]
[Epoch 48]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:05<00:00,  4.64it/s, loss=1.6]
[Epoch 49]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:07<00:00,  4.58it/s, loss=1.6]
[Epoch 50]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.75it/s, loss=1.59]
[Epoch 51]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:00<00:00,  4.81it/s, loss=1.62]
[Epoch 52]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.77it/s, loss=1.63]
[Epoch 53]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.67it/s, loss=1.56]
[Epoch 54]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:00<00:00,  4.82it/s, loss=1.59]
[Epoch 55]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.68it/s, loss=1.6]
[Epoch 56]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.74it/s, loss=1.61]
[Epoch 57]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.81it/s, loss=1.6]
[Epoch 58]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:05<00:00,  4.64it/s, loss=1.6]
[Epoch 59]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.73it/s, loss=1.6]
[Epoch 60]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:05<00:00,  4.62it/s, loss=1.61]
[Epoch 61]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:05<00:00,  4.66it/s, loss=1.6]
[Epoch 62]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.80it/s, loss=1.56]
[Epoch 63]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.73it/s, loss=1.58]
[Epoch 64]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.72it/s, loss=1.59]
[Epoch 65]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.69it/s, loss=1.62]
[Epoch 66]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:09<00:00,  4.50it/s, loss=1.57]
[Epoch 67]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:07<00:00,  4.57it/s, loss=1.56]
[Epoch 68]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [01:59<00:00,  4.88it/s, loss=1.56]
[Epoch 69]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:06<00:00,  4.60it/s, loss=1.55]
[Epoch 70]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.77it/s, loss=1.58]
[Epoch 71]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:00<00:00,  4.82it/s, loss=1.55]
[Epoch 72]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.77it/s, loss=1.53]
[Epoch 73]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:05<00:00,  4.64it/s, loss=1.59]
[Epoch 74]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.76it/s, loss=1.55]
[Epoch 75]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:00<00:00,  4.81it/s, loss=1.56]
[Epoch 76]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.76it/s, loss=1.57]
[Epoch 77]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.80it/s, loss=1.59]
[Epoch 78]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.73it/s, loss=1.57]
[Epoch 79]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.70it/s, loss=1.59]
[Epoch 80]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.73it/s, loss=1.57]
[Epoch 81]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:17<00:00,  4.22it/s, loss=1.55]
[Epoch 82]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:22<00:00,  4.07it/s, loss=1.56]
[Epoch 83]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:19<00:00,  4.17it/s, loss=1.57]
[Epoch 84]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:16<00:00,  4.27it/s, loss=1.55]
[Epoch 85]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:15<00:00,  4.29it/s, loss=1.55]
[Epoch 86]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:20<00:00,  4.14it/s, loss=1.56]
[Epoch 87]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:20<00:00,  4.14it/s, loss=1.56]
[Epoch 88]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:10<00:00,  4.47it/s, loss=1.56]
[Epoch 89]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:28<00:00,  3.92it/s, loss=1.59]
[Epoch 90]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:24<00:00,  4.02it/s, loss=1.54]
[Epoch 91]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:17<00:00,  4.24it/s, loss=1.59]
[Epoch 92]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:23<00:00,  4.05it/s, loss=1.59]
[Epoch 93]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:19<00:00,  4.17it/s, loss=1.56]
[Epoch 94]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:14<00:00,  4.33it/s, loss=1.59]
[Epoch 95]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:20<00:00,  4.14it/s, loss=1.59]
[Epoch 96]: 100%|████████████████████████████████████████████████████████████████████████████████| 582/582 [02:19<00:00,  4.18it/s, loss=1.6]
[Epoch 97]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:12<00:00,  4.38it/s, loss=1.56]
[Epoch 98]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:13<00:00,  4.37it/s, loss=1.53]
[Epoch 99]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:16<00:00,  4.25it/s, loss=1.55]
[Epoch 100]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:19<00:00,  4.18it/s, loss=1.55]
[Epoch 101]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:12<00:00,  4.40it/s, loss=1.61]
[Epoch 102]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:18<00:00,  4.19it/s, loss=1.56]
[Epoch 103]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:19<00:00,  4.16it/s, loss=1.58]
[Epoch 104]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:19<00:00,  4.18it/s, loss=1.55]
[Epoch 105]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:19<00:00,  4.16it/s, loss=1.57]
[Epoch 106]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:19<00:00,  4.17it/s, loss=1.55]
[Epoch 107]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:19<00:00,  4.18it/s, loss=1.56]
[Epoch 108]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.70it/s, loss=1.57]
[Epoch 109]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [01:59<00:00,  4.87it/s, loss=1.6]
[Epoch 110]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.77it/s, loss=1.54]
[Epoch 111]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.77it/s, loss=1.58]
[Epoch 112]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.72it/s, loss=1.55]
[Epoch 113]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.78it/s, loss=1.55]
[Epoch 114]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.75it/s, loss=1.59]
[Epoch 115]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:06<00:00,  4.61it/s, loss=1.59]
[Epoch 116]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.78it/s, loss=1.6]
[Epoch 117]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.71it/s, loss=1.57]
[Epoch 118]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.66it/s, loss=1.55]
[Epoch 119]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.71it/s, loss=1.56]
[Epoch 120]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.69it/s, loss=1.6]
[Epoch 121]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:00<00:00,  4.83it/s, loss=1.59]
[Epoch 122]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.70it/s, loss=1.52]
[Epoch 123]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:06<00:00,  4.61it/s, loss=1.57]
[Epoch 124]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:26<00:00,  3.98it/s, loss=1.56]
[Epoch 125]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:45<00:00,  3.53it/s, loss=1.52]
[Epoch 126]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:53<00:00,  3.35it/s, loss=1.59]
[Epoch 127]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:57<00:00,  3.28it/s, loss=1.56]
[Epoch 128]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:59<00:00,  3.24it/s, loss=1.55]
[Epoch 129]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:55<00:00,  3.31it/s, loss=1.58]
[Epoch 130]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:42<00:00,  3.59it/s, loss=1.55]
[Epoch 131]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:40<00:00,  3.63it/s, loss=1.61]
[Epoch 132]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [03:01<00:00,  3.20it/s, loss=1.56]
[Epoch 133]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:56<00:00,  3.30it/s, loss=1.6]
[Epoch 134]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:50<00:00,  3.40it/s, loss=1.58]
[Epoch 135]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:51<00:00,  3.40it/s, loss=1.53]
[Epoch 136]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:43<00:00,  3.55it/s, loss=1.51]
[Epoch 137]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:17<00:00,  4.25it/s, loss=1.54]
[Epoch 138]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:18<00:00,  4.20it/s, loss=1.6]
[Epoch 139]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:19<00:00,  4.17it/s, loss=1.56]
[Epoch 140]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:20<00:00,  4.15it/s, loss=1.56]
[Epoch 141]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:19<00:00,  4.17it/s, loss=1.57]
[Epoch 142]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:19<00:00,  4.18it/s, loss=1.6]
[Epoch 143]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:20<00:00,  4.15it/s, loss=1.53]
[Epoch 144]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:15<00:00,  4.30it/s, loss=1.55]
[Epoch 145]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:20<00:00,  4.13it/s, loss=1.61]
[Epoch 146]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:19<00:00,  4.16it/s, loss=1.56]
[Epoch 147]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:20<00:00,  4.15it/s, loss=1.6]
[Epoch 148]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:22<00:00,  4.09it/s, loss=1.54]
[Epoch 149]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:25<00:00,  3.99it/s, loss=1.53]
[Epoch 150]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:18<00:00,  4.19it/s, loss=1.6]
[Epoch 151]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:24<00:00,  4.03it/s, loss=1.52]
[Epoch 152]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:07<00:00,  4.58it/s, loss=1.58]
[Epoch 153]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.69it/s, loss=1.53]
[Epoch 154]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:06<00:00,  4.60it/s, loss=1.55]
[Epoch 155]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.67it/s, loss=1.58]
[Epoch 156]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.75it/s, loss=1.52]
[Epoch 157]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.76it/s, loss=1.56]
[Epoch 158]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.75it/s, loss=1.6]
[Epoch 159]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.77it/s, loss=1.59]
[Epoch 160]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [01:58<00:00,  4.92it/s, loss=1.53]
[Epoch 161]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.75it/s, loss=1.57]
[Epoch 162]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:07<00:00,  4.58it/s, loss=1.56]
[Epoch 163]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.80it/s, loss=1.55]
[Epoch 164]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:05<00:00,  4.65it/s, loss=1.58]
[Epoch 165]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:05<00:00,  4.63it/s, loss=1.55]
[Epoch 166]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.78it/s, loss=1.56]
[Epoch 167]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.72it/s, loss=1.59]
[Epoch 168]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:06<00:00,  4.60it/s, loss=1.52]
[Epoch 169]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.69it/s, loss=1.55]
[Epoch 170]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [01:58<00:00,  4.91it/s, loss=1.56]
[Epoch 171]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.67it/s, loss=1.58]
[Epoch 172]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:06<00:00,  4.61it/s, loss=1.55]
[Epoch 173]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.69it/s, loss=1.62]
[Epoch 174]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.68it/s, loss=1.56]
[Epoch 175]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.67it/s, loss=1.54]
[Epoch 176]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:00<00:00,  4.85it/s, loss=1.55]
[Epoch 177]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.78it/s, loss=1.62]
[Epoch 178]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:06<00:00,  4.60it/s, loss=1.54]
[Epoch 179]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.73it/s, loss=1.6]
[Epoch 180]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [01:58<00:00,  4.91it/s, loss=1.53]
[Epoch 181]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.70it/s, loss=1.56]
[Epoch 182]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.74it/s, loss=1.57]
[Epoch 183]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.77it/s, loss=1.58]
[Epoch 184]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:05<00:00,  4.62it/s, loss=1.56]
[Epoch 185]: 100%|███████████████████████████████████████████████████████████████████████████████| 582/582 [02:05<00:00,  4.65it/s, loss=1.6]
[Epoch 186]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.67it/s, loss=1.55]
[Epoch 187]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.72it/s, loss=1.54]
[Epoch 188]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.77it/s, loss=1.57]
[Epoch 189]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:03<00:00,  4.73it/s, loss=1.54]
[Epoch 190]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:00<00:00,  4.83it/s, loss=1.56]
[Epoch 191]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:04<00:00,  4.67it/s, loss=1.58]
[Epoch 192]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.81it/s, loss=1.55]
[Epoch 193]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:00<00:00,  4.82it/s, loss=1.55]
[Epoch 194]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:01<00:00,  4.79it/s, loss=1.57]
[Epoch 195]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [01:58<00:00,  4.93it/s, loss=1.57]
[Epoch 196]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [01:58<00:00,  4.92it/s, loss=1.55]
[Epoch 197]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [01:56<00:00,  4.98it/s, loss=1.55]
[Epoch 198]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:00<00:00,  4.83it/s, loss=1.58]
[Epoch 199]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [02:02<00:00,  4.77it/s, loss=1.56]
[Epoch 200]: 100%|██████████████████████████████████████████████████████████████████████████████| 582/582 [01:56<00:00,  5.02it/s, loss=1.56]
2021-03-08 00:35:37.985470, 0 ok, hit = 3
2021-03-08 02:04:16.462421, 2000 ok, hit = 1999
2021-03-08 03:24:55.131880, 4000 ok, hit = 2932
2021-03-08 04:43:13.330376, 6000 ok, hit = 3732
2021-03-08 06:02:03.384492, 8000 ok, hit = 4447
2021-03-08 07:15:22.972354, 10000 ok, hit = 5215
2021-03-08 08:20:45.397370, 12000 ok, hit = 5871
2021-03-08 09:26:06.975837, 14000 ok, hit = 6616
2021-03-08 10:31:28.466704, 16000 ok, hit = 7344
2021-03-08 11:36:53.701873, 18000 ok, hit = 8203
2021-03-08 12:42:15.278925, 20000 ok, hit = 9060
2021-03-08 13:47:39.767090, 22000 ok, hit = 9949
2021-03-08 15:12:01.081589, 24000 ok, hit = 10868
2021-03-08 16:55:54.393674, 26000 ok, hit = 11880
2021-03-08 18:55:19.074004, 28000 ok, hit = 12836
2021-03-08 20:00:37.131824, 30000 ok, hit = 13989
2021-03-08 21:05:54.108867, 32000 ok, hit = 14990
2021-03-08 22:11:12.169466, 34000 ok, hit = 16080
2021-03-08 23:16:27.729504, 36000 ok, hit = 17227
2021-03-09 00:21:42.378780, 38000 ok, hit = 18353
2021-03-09 01:26:57.642811, 40000 ok, hit = 19495
2021-03-09 02:32:12.033647, 42000 ok, hit = 20742
2021-03-09 03:37:26.729950, 44000 ok, hit = 21922
2021-03-09 04:42:41.127358, 46000 ok, hit = 23130
2021-03-09 05:48:02.065974, 48000 ok, hit = 24370
2021-03-09 06:53:18.541155, 50000 ok, hit = 25617
2021-03-09 07:58:40.528849, 52000 ok, hit = 26919
HR@20 = 0.18973082841023498, Recall@20 = 0.03264866061141291, NDCG@20 = 0.025157675479624726, HR@50 = 0.3192447238949148, Recall@50 = 0.06233696568369639, NDCG@50 = 0.036139451566635825
```


